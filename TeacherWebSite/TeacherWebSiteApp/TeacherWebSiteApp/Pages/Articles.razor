@page "/articles"
@inject IDbContextFactory<TeacherContext> DbFactory
@inject NavigationManager NavManager
@layout MainLayout


<div style="display: flex; align-items: center; margin-top: 60px">
    <div style="text-align: center; display: block; width: 100%">
        <h3>Читайте наши статьи и новости</h3>
    </div>
</div>

<Row Style="position: center">
    @foreach (var article in articles)
    {
        <AntDesign.Col Span="6" Style="margin: auto; margin-top: 25px; margin-bottom: 25px">
            <Card Title="@(article.Name)" Bordered="true" Style="width:100%; min-height: 300px; border-radius: 20px;">
                <Body>
                    <div style="background-image: url(data:image/png;base64,@Convert.ToBase64String(article.Blocks.FirstOrDefault()?.Image));
                            height: 200px; background-size: cover; background-position: center">
                    </div>
                    <div style="font-weight: 200">
                        <div class="truncate">
                            <p>@article.Description</p>
                        </div>
                            
                    </div>
                    <Button Icon="@IconType.Outline.ArrowRight"><a href="/article/@article.Id">Читать</a></Button>
                </Body>
            </Card>

                @*<style>
                </style>
                <MatCard class="demo-mat-card">
                    <MatCardContent>
                        <MatCardMedia Wide="true">
                            <div style="background-image: url(data:image/png;base64,@Convert.ToBase64String(article.Blocks.FirstOrDefault()?.Image));
                                height: 150px; background-size: cover; background-position: center">
                            </div>
                        </MatCardMedia>
                        <div class="demo-mat-card-content">
                            <MatHeadline6 class="demo-mat-card-clean-margin">
                                @article.Name
                            </MatHeadline6>
                        </div>

                        <MatBody2 class="demo-mat-card-content demo-mat-card-clean-margin">
                            @article.Description
                        </MatBody2>
                    </MatCardContent>
                    <MatCardActions>
                        <Button Icon="@IconType.Outline.ArrowRight"><a href="/article/@article.Id">Читать</a></Button>
                    </MatCardActions>
                </MatCard>*@
        </AntDesign.Col>
     }
</Row>


@code { List<Article> articles = new();

        protected override async Task OnInitializedAsync()
        {
            using TeacherContext context = DbFactory.CreateDbContext();
            articles = await context.Articles.Where(a => a.IsActive.Value).Include(a => a.Blocks).ToListAsync();
        } 
    }
